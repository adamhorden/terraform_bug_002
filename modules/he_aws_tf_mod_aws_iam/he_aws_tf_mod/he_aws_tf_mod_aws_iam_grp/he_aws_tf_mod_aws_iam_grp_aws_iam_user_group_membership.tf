# Copyright (c) 2018 - 2020 Adam Horden <adam.horden@horden.engineering>

# ----------------------------------------------------------------------------------------
# Resource:
# ----------------------------------------------------------------------------------------

# aws_iam_group.this

resource aws_iam_user_group_membership this {

  # --------------------------------------------------------------------------------------
  # For:
  # --------------------------------------------------------------------------------------

  for_each = length(
    local.he_aws_tf_mod_aws_iam_grp_aws_iam_usr_grp_mem
  ) > 0 ? local.he_aws_tf_mod_aws_iam_grp_aws_iam_usr_grp_mem : {}

  # --------------------------------------------------------------------------------------
  # Depends:
  # --------------------------------------------------------------------------------------

  depends_on = [
    aws_iam_group.this,
  ]

  # --------------------------------------------------------------------------------------
  # Provider:
  # --------------------------------------------------------------------------------------

  provider = aws.he_aws_tf_app

  # --------------------------------------------------------------------------------------
  # Argument:
  # --------------------------------------------------------------------------------------

  groups = [
    format(
      "%s",
      lookup(
        aws_iam_group.this[
          each.key
        ],
        "name",
        "",
      ),
    ),
  ]

  # --------------------------------------------------------------------------------------
  # Arguments:
  # --------------------------------------------------------------------------------------

  user = local.he_aws_tf_mod_aws_iam_grp_aws_iam_usr_grp_mem_user

}
